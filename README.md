# 视频变化检测脚本

专为大规模批量处理设计的高效视频变化检测工具，能快速判断视频前4秒（第0、1、2、3秒）是否完全没有变化。

## 🚀 特点

- **极速处理**: 针对5万个视频优化，使用感知哈希算法
- **多进程并行**: 充分利用多核CPU
- **内存优化**: 低内存占用，适合大批量处理
- **易于使用**: 提供命令行界面和批处理脚本
- **双版本选择**: 极速版本和精确版本

## 📦 文件结构

```
├── fast_video_detector.py      # 极速版本（推荐）
├── video_change_detector.py    # 精确版本
├── batch_process.sh            # 批处理脚本
├── requirements.txt            # 依赖文件
├── 使用说明.md                 # 详细使用说明
└── README.md                   # 本文件
```

## 🛠️ 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 处理单个视频

```bash
python3 fast_video_detector.py video.mp4
```

### 3. 批量处理目录

```bash
python3 fast_video_detector.py /path/to/videos/ -o results.csv
```

### 4. 使用批处理脚本

```bash
./batch_process.sh /path/to/videos/ results.csv 8
```

## ⚡ 性能

- **处理速度**: 10-50个视频/秒（取决于硬件和视频大小）
- **内存占用**: 极低，适合大批量处理
- **预计时间**: 处理5万个视频约20分钟-2小时

## 📊 输出格式

结果以CSV格式保存：

```csv
视频文件,无变化,详情
"/path/video1.mp4",True,"无变化"
"/path/video2.mp4",False,"第2秒有变化"
```

## 🔧 主要参数

- `-j`: 并行进程数（默认为CPU核心数）
- `--hash-threshold`: 检测敏感度（默认8，越小越严格）
- `-o`: 输出文件路径
- `-q`: 静默模式

## 📖 详细文档

查看 [使用说明.md](使用说明.md) 获取完整的使用指南和优化建议。

## 🎯 算法原理

1. **感知哈希**: 将帧缩放到8x8像素，生成64位哈希值
2. **汉明距离**: 比较哈希值的位差异
3. **阈值判断**: 超过阈值认为有变化

## 📝 示例输出

```
找到 1000 个视频文件
使用 8 个进程

处理完成!
总数: 1000
无变化: 156
有变化: 844
用时: 45.67 秒
速度: 21.9 个/秒
```

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个工具！

## 📄 许可证

MIT License
